<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>WNIT Intelligence ‚ú®</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;800&display=swap" rel="stylesheet" />

<style>
:root{
  --gold:#bfa181;
  --gold-light:#e5e5e5;
  --panel:rgba(28,28,28,.88);
  --border:rgba(191,161,129,.35);
  --text:#e5e5e5;
  --muted:#a0a0a0;
}

*{box-sizing:border-box}

body{
  margin:0;
  font-family:Poppins,sans-serif;
  background:radial-gradient(circle at top,#1a1a1a,#000);
  color:var(--text);
}

/* HEADER */
.top-bar{
  height:64px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:0 28px;
  border-bottom:1px solid var(--border);
  background:rgba(0,0,0,.7);
  backdrop-filter:blur(10px);
  position:sticky;
  top:0;
  z-index:10;
}

.brand{
  font-weight:700;
  background:linear-gradient(135deg,var(--gold),var(--gold-light));
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
}

.back{
  color:var(--muted);
  text-decoration:none;
}
.back:hover{color:var(--gold)}

/* LAYOUT */
.container{
  max-width:900px;
  margin:auto;
  padding:30px 20px 140px;
}

.intro{
  text-align:center;
  margin-bottom:30px;
}

.intro-box{
  display:inline-block;
  padding:14px 26px;
  border-radius:999px;
  background:var(--panel);
  border:1px solid var(--border);
  box-shadow:0 0 25px rgba(191,161,129,.2);
  font-size:14px;
}

/* CHAT */
.chat{
  display:flex;
  flex-direction:column;
  gap:18px;
}

.msg{
  max-width:92%;
  padding:16px 18px;
  border-radius:16px;
  line-height:1.7;
  animation:fade .3s ease;
}

.user{
  margin-left:auto;
  border:1px solid var(--border);
  background:linear-gradient(135deg,#1c1c1c,#000);
}

.ai{
  background:var(--panel);
  border:1px solid var(--border);
}

.city{
  margin:18px 0 6px;
  font-weight:700;
  color:var(--gold);
}

/* CARD */
.card{
  display:flex;
  gap:14px;
  padding:14px;
  border-radius:18px;
  background:rgba(18,18,18,.9);
  border:1px solid var(--border);
  margin-top:12px;
  cursor:pointer;
  position:relative;
  overflow:hidden;
  transition:.3s;
}

.card:hover{
  transform:translateY(-3px);
  box-shadow:0 0 35px rgba(191,161,129,.35);
}

.card::after{
  content:"";
  position:absolute;
  inset:0;
  background:linear-gradient(120deg,transparent 40%,rgba(191,161,129,.08),transparent 60%);
  opacity:0;
  transition:.3s;
}
.card:hover::after{opacity:1}

.card img{
  width:96px;
  height:96px;
  border-radius:14px;
  object-fit:cover;
}

.card-body{flex:1}

.card-body h4{
  margin:0;
  font-size:16px;
}

.card-meta{
  font-size:13px;
  color:var(--muted);
  margin-top:4px;
}

.card-tags{
  margin-top:6px;
  font-size:13px;
}

.ai-tag{
  display:inline-block;
  margin-top:6px;
  padding:3px 8px;
  font-size:11px;
  border-radius:999px;
  color:var(--gold);
  background:rgba(191,161,129,.15);
  border:1px solid var(--border);
}

.view{
  margin-top:6px;
  font-size:13px;
  color:var(--gold);
}

.bookmark{
  position:absolute;
  top:12px;
  right:14px;
  font-size:18px;
  color:var(--muted);
  cursor:pointer;
}
.bookmark.active{color:var(--gold)}

.fade{
  opacity:0;
  animation:fadeUp .45s ease forwards;
}

@keyframes fade{
  from{opacity:0;transform:translateY(8px)}
  to{opacity:1;transform:none}
}

@keyframes fadeUp{
  to{opacity:1;transform:none}
}

/* INPUT */
.input-bar{
  position:fixed;
  bottom:0;
  width:100%;
  padding:16px 20px;
  background:rgba(0,0,0,.85);
  backdrop-filter:blur(10px);
  border-top:1px solid var(--border);
}

.input-inner{
  max-width:900px;
  margin:auto;
  display:flex;
  gap:12px;
}

input{
  flex:1;
  padding:14px 20px;
  border-radius:999px;
  border:1px solid var(--border);
  background:#000;
  color:var(--text);
}

button{
  padding:0 26px;
  border-radius:999px;
  border:none;
  cursor:pointer;
  font-weight:600;
  background:linear-gradient(135deg,var(--gold),var(--gold-light));
}
</style>
</head>

<body>

<div class="top-bar">
  <a href="/" class="back">‚Üê Back</a>
  <div class="brand">WNIT Intelligence ‚ú®</div>
</div>

<div class="container">
  <div class="intro">
    <div class="intro-box">
      Hello! I‚Äôm your AI concierge. Ask about <b>restaurants, caf√©s, nightlife</b> ‚ú®
    </div>
  </div>

  <div id="chat" class="chat"></div>
</div>

<div class="input-bar">
  <div class="input-inner">
    <input id="query" placeholder="Ask anything‚Ä¶" onkeypress="if(event.key==='Enter') sendQuery()" />
    <button onclick="sendQuery()">Send</button>
  </div>
</div>

<script>
async function sendQuery(){
  const input=document.getElementById("query");
  const text=input.value.trim();
  if(!text)return;
  input.value="";

  const chat=document.getElementById("chat");
  chat.innerHTML+=`<div class="msg user">${text}</div>`;

  const thinking=document.createElement("div");
  thinking.className="msg ai";
  thinking.innerText="Thinking...";
  chat.appendChild(thinking);

  const res=await fetch("/ai-search",{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({query:text})
  });

  const data=await res.json();
  thinking.remove();

  let html=`<div class="msg ai">`;

  if(!data.results||Object.keys(data.results).length===0){
    html+="No relevant places found.";
  }else{
    for(const city in data.results){
      html+=`<div class="city">${city}</div>`;
      data.results[city].forEach((r,i)=>{
        html+=`
        <div class="card fade" style="animation-delay:${i*80}ms"
             onclick="location.href='/restaurant/${r.id}'">

          <div class="bookmark" onclick="event.stopPropagation();toggle(this)">‚òÜ</div>

          <img src="${r.image||'/static/no-image.jpg'}"
               onerror="this.src='/static/no-image.jpg'">

          <div class="card-body">
            <h4>${r.name}</h4>
            <div class="card-meta">üìç ${r.locality}, ${r.city}</div>
            <div class="card-tags">üçΩ ${r.cuisines}</div>
            <div class="ai-tag">ü§ñ Recommended for you</div>
            <div class="card-meta">‚≠ê ${r.rating??"N/A"} ‚Ä¢ üî• ${r.score.toFixed(3)}</div>
            <div class="view">View details ‚Üí</div>
          </div>
        </div>`;
      });
    }
  }

  html+=`</div>`;
  chat.innerHTML+=html;
  chat.scrollTop=chat.scrollHeight;
}

function toggle(el){
  el.classList.toggle("active");
  el.innerText=el.classList.contains("active")?"‚òÖ":"‚òÜ";
}
</script>

</body>
</html>
